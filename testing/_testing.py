import pandas as pd
import time
import json
import asyncio
import ccxt.async_support as ccxt

APIkey = "XxnvexcTFwnf7Rj1fw"
APIsecret = "9QMu3OQ94Vr1gPoTSUKgq8ke4m20wc9uDsl0"

exchange = ccxt.bybit({
    "apiKey": APIkey,
    "secret": APIsecret
})

data = [[1634256000000, 1.865, 1.919, 1.774, 1.785, 6783896.3], [1634342400000, 1.785, 1.81, 1.776, 1.785, 4947339.6], [1634428800000, 1.785, 1.81, 1.734, 1.799, 5361588.6], [1634515200000, 1.799, 1.888, 1.783, 1.807, 13401997.4], [1634601600000, 1.807, 2.009, 1.796, 2.001, 26614593.7], [1634688000000, 2.001, 2.495, 1.995, 2.371, 140310023.9], [1634774400000, 2.371, 2.405, 2.167, 2.198, 122364116.7], [1634860800000, 2.198, 2.317, 2.122, 2.158, 78927583.2], [1634947200000, 2.158, 2.278, 2.151, 2.263, 35540400.7], [1635033600000, 2.263, 2.27, 2.157, 2.209, 23314002.6], [1635120000000, 2.209, 2.466, 2.205, 2.408, 38782099.7], [1635206400000, 2.408, 2.435, 2.285, 2.301, 26504783.7], [1635292800000, 2.301, 2.363, 2.213, 2.221, 21566333.3], [1635379200000, 2.221, 2.44, 2.185, 2.393, 22634370.1], [1635465600000, 2.393, 2.755, 2.385, 2.716, 49355758.5], [1635552000000, 2.716, 2.873, 2.662, 2.835, 50364744.1], [1635638400000, 2.835, 2.871, 2.635, 2.751, 50886416.8], [1635724800000, 2.751, 2.821, 2.654, 2.736, 33925089.3], [1635811200000, 2.736, 2.912, 2.715, 2.88, 23938054.5], [1635897600000, 2.88, 2.897, 2.736, 2.827, 24246723.4], [1635984000000, 2.827, 2.836, 2.645, 2.661, 24829785.9], [1636070400000, 2.661, 2.772, 2.46, 2.611, 61904328.5], [1636156800000, 2.611, 2.724, 2.591, 2.68, 26823449.1], [1636243200000, 2.68, 2.738, 2.671, 2.731, 16345594.3], [1636329600000, 2.731, 2.859, 2.731, 2.847, 22374120.8], [1636416000000, 2.847, 2.986, 2.834, 2.897, 39534519.0], [1636502400000, 2.897, 3.051, 2.766, 2.833, 45521830.3], [1636588800000, 2.833, 2.978, 2.814, 2.961, 27554255.5], [1636675200000, 2.961, 3.084, 2.818, 2.894, 46783522.7], [1636761600000, 2.894, 2.911, 2.812, 2.857, 16698637.9], [1636848000000, 2.857, 2.88, 2.718, 2.801, 18117359.5], [1636934400000, 2.801, 2.835, 2.651, 2.689, 23417850.1], [1637020800000, 2.689, 2.689, 2.419, 2.508, 48058564.3], [1637107200000, 2.508, 2.58, 2.402, 2.576, 33771472.1], [1637193600000, 2.576, 2.637, 2.384, 2.404, 59779489.8], [1637280000000, 2.404, 2.545, 2.398, 2.538, 22257429.1], [1637366400000, 2.538, 2.623, 2.493, 2.617, 18915014.8], [1637452800000, 2.617, 2.626, 2.53, 2.569, 13779432.5], [1637539200000, 2.569, 2.586, 2.455, 2.488, 22627717.9], [1637625600000, 2.488, 2.564, 2.469, 2.547, 15564611.5], [1637712000000, 2.547, 2.555, 2.454, 2.462, 12956566.5], [1637798400000, 2.462, 2.496, 2.321, 2.446, 38745329.5], [1637884800000, 2.446, 2.457, 2.202, 2.296, 30909536.7], [1637971200000, 2.296, 2.375, 2.291, 2.347, 10089369.0], [1638057600000, 2.347, 2.382, 2.233, 2.38, 14152015.5], [1638144000000, 2.38, 2.435, 2.355, 2.36, 9577102.9], [1638230400000, 2.36, 2.426, 2.286, 2.343, 14934874.1], [1638316800000, 2.343, 2.416, 2.33, 2.343, 11463587.5], [1638403200000, 2.343, 2.355, 2.264, 2.266, 15006769.1], [1638489600000, 2.266, 2.323, 1.981, 2.086,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               22675453.7], [1638576000000, 2.086, 2.09, 1.574, 1.899, 39552389.8], [1638662400000, 1.899, 1.954, 1.841, 1.896, 15498524.7], [1638748800000, 1.896, 1.926, 1.799, 1.912, 12970582.0], [1638835200000, 1.912, 1.985, 1.905, 1.981, 12091193.1], [1638921600000, 1.981, 2.065, 1.943, 2.061, 14606117.7], [1639008000000, 2.061, 2.078, 1.878, 1.9, 12893777.6], [1639094400000, 1.9, 1.945, 1.786, 1.795, 16604891.7], [1639180800000, 1.795, 1.868, 1.77, 1.86, 9727561.9], [1639267200000, 1.86, 1.894, 1.82, 1.884, 7079233.2], [1639353600000, 1.884, 1.891, 1.708, 1.756, 14326574.1], [1639440000000, 1.756, 1.802, 1.726, 1.802, 8429209.7], [1639526400000, 1.802, 1.87, 1.705, 1.83, 15507961.8], [1639612800000, 1.83, 1.89, 1.824, 1.844, 13603451.3], [1639699200000, 1.844, 1.919, 1.797, 1.903, 16418453.2], [1639785600000, 1.903, 1.96, 1.852, 1.938, 15185470.6], [1639872000000, 1.938, 1.975, 1.898, 1.929, 11048110.5], [1639958400000, 1.929, 1.95, 1.797, 1.862, 20745019.2], [1640044800000, 1.862, 1.913, 1.836, 1.891, 8682178.5], [1640131200000, 1.891, 1.911, 1.84, 1.858, 6811259.6], [1640217600000, 1.858, 1.935, 1.823, 1.906, 7390433.9], [1640304000000, 1.906, 1.921, 1.864, 1.874, 6973030.5], [1640390400000, 1.874, 1.916, 1.867, 1.895, 3924490.5], [1640476800000, 1.895, 1.895, 1.84, 1.877, 5400725.2], [1640563200000, 1.877, 1.942, 1.851, 1.861, 11611078.0], [1640649600000, 1.861, 1.862, 1.77, 1.802, 14530937.4], [1640736000000, 1.802, 1.824, 1.767, 1.776, 9594523.4], [1640822400000, 1.776, 1.896, 1.76, 1.883, 9889365.1], [1640908800000, 1.883, 1.984, 1.876, 1.944, 17133091.3], [1640995200000, 1.944, 2.092, 1.944, 2.092, 14592104.2], [1641081600000, 2.092, 2.146, 2.041, 2.14, 15905783.5], [1641168000000, 2.14, 2.19, 2.065, 2.118, 24525145.5], [1641254400000, 2.118, 2.164, 2.046, 2.091, 22929148.6], [1641340800000, 2.091, 2.093, 1.801, 1.866, 58584187.3], [1641427200000, 1.866, 1.959, 1.83, 1.94, 16607965.3], [1641513600000, 1.94, 1.948, 1.803, 1.897, 21980357.7], [1641600000000, 1.897, 1.962, 1.823, 1.877, 15639671.1], [1641686400000, 1.877, 1.919, 1.851, 1.866, 9739764.9], [1641772800000, 1.866, 1.936, 1.837, 1.879, 23832886.5], [1641859200000, 1.879, 1.948, 1.866, 1.933, 15378234.3], [1641945600000, 1.933, 2.098, 1.924, 2.092, 22456213.2], [1642032000000, 2.092, 2.106, 2.023, 2.041, 21508481.2], [1642118400000, 2.041, 2.065, 1.972, 2.029, 16615099.3], [1642204800000, 2.029, 2.034, 1.997, 2.007, 9064589.1], [1642291200000, 2.007, 2.02, 1.985, 2.002, 9850279.4], [1642377600000, 2.002, 2.002, 1.88, 1.903, 25389904.4], [1642464000000, 1.903, 1.955, 1.805, 1.935, 68192110.3], [1642550400000, 1.935, 1.988, 1.898, 1.962, 32507004.6], [1642636800000, 1.962, 2.026, 1.914, 1.926, 20314848.2], [1642723200000, 1.926, 1.944, 1.737, 1.776, 37445569.3], [1642809600000, 1.776, 1.806, 1.483, 1.541, 49249076.8]]
df = pd.DataFrame(data)
print(df)


# async def fetch_markets():
#     markets = await exchange.load_markets()
#     await exchange.close()
#     return markets
#     if exchange.has['fetchOHLCV']:
#         for symbol in exchange.markets:
#             time.sleep(exchange.rateLimit / 1000)  # time.sleep wants seconds
#             val = await exchange.fetch_ohlcv(
#                 symbol, '1d', limit=100)
#             print(symbol)  # one day

# if __name__ == "__main__":
#     async def main_def():
#         balance = await asyncio.gather(fetch_markets())
#         print(json.dumps(balance[0], indent=2, sort_keys=True))
#         with open('data.txt', 'w') as outfile:
#             json.dump(balance, outfile, indent=2, sort_keys=True)


# balance = asyncio.run(main_def())
